#!/bin/sh
cd ${0%/*} || exit 1    # Run from this directory

# Source tutorial clean functions
. $WM_PROJECT_DIR/bin/tools/CleanFunctions

# 1. Nettoyage standard (Temps, Post-traitement)
cleanCase

# 2. Nettoyage des maillages
echo "Nettoyage des maillages..."
rm -rf constant/polyMesh            # Maillage global (snappy)
rm -rf constant/fluid/polyMesh      # Maillage région fluide
rm -rf constant/solid/polyMesh      # Maillage région solide

# 3. Nettoyage des données de processeurs et logs
rm -rf processor*
rm -rf log.*
rm -rf *.log
rm -rf dynamicCode

# 4. Gestion du dossier 0 (Conditions Limites)
# SÉCURITÉ : On ne supprime 0 que si une sauvegarde 0.orig existe.
if [ -d "0.orig" ]; then
    echo "Restauration du dossier 0 depuis 0.orig..."
    rm -rf 0
    cp -r 0.orig 0
else
    echo "Note : Le dossier 0 a été conservé (pas de 0.orig détecté)."
    # On nettoie quand même les fichiers 'backup' générés par le solveur dans 0
    rm -f 0/*.old 0/*~
fi

# 5. On NE TOUCHE PAS aux STL
# constant/triSurface est préservé car il vient de Windows.

echo "Nettoyage terminé."
